- hosts: all
  tasks:
    - name: Ensure logs directory exists
      file:
        path: "{{ ansible_user_dir }}/zuul-output/logs/logs"
        state: directory

    - name: Prepare nodepool log files
      synchronize:
        dest: "{{ ansible_user_dir }}/zuul-output/logs/logs"
        rsync_opts:
          - "--relative"
        src: /var/log/nodepool
        verify_host: true
      delegate_to: "{{ inventory_hostname }}"

    - name: Execute fetch-zuul-logs role
      include_role:
        name: fetch-zuul-logs
